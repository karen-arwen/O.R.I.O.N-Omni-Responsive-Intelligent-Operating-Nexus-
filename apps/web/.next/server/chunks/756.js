"use strict";exports.id=756,exports.ids=[756],exports.modules={9756:(e,t,s)=>{s.d(t,{Z:()=>AppShell});var a=s(4196),i=s(4288),r=s.n(i),n=s(4555),l=s(8726),o=s(2135),c=s(8528),d=s(4291),m=s(7371),x=s(6620),u=s(1155),h=s(2995),p=s(5516);let g=[{href:"/",label:"Overview",icon:c.Z,roles:["member","admin","public"]},{href:"/timeline",label:"Timeline",icon:d.Z,roles:["member","admin"]},{href:"/decisions",label:"Decisions",icon:m.Z,roles:["member","admin"]},{href:"/trust",label:"Trust",icon:x.Z,roles:["admin"]},{href:"/settings",label:"Settings",icon:u.Z,roles:["member","admin","public"]}];function Sidebar(){let e=(0,n.usePathname)(),[t,s]=(0,l.useState)(!0),[i,c]=(0,l.useState)([]);(0,l.useEffect)(()=>{let e=(0,p.u)();c(e.roles??[])},[]);let canSee=e=>{if(!e.length)return!0;let t=new Set(i.map(e=>e.toLowerCase()));return e.some(e=>t.has(e.toLowerCase()))};return(0,a.jsxs)("aside",{className:(0,o.cn)("hidden md:flex flex-col border-r border-white/10 bg-white/5 backdrop-blur-xl transition-all",t?"w-60":"w-16"),children:[(0,a.jsxs)("div",{className:"p-4 flex items-center justify-between",children:[a.jsx("div",{className:"text-lg font-semibold",children:"O.R.I.O.N"}),a.jsx("button",{"aria-label":"Toggle sidebar",className:"text-xs text-muted-foreground",onClick:()=>s(e=>!e),children:t?"⟨":"⟩"})]}),a.jsx("nav",{className:"flex-1 space-y-1 px-2",children:g.filter(e=>canSee(e.roles)).map(({href:s,label:i,icon:n})=>{let l=e===s;return(0,a.jsxs)(r(),{href:s,className:(0,o.cn)("flex items-center gap-3 rounded-lg px-3 py-2 text-sm transition",l?"bg-primary/20 text-primary-foreground":"text-muted-foreground hover:bg-white/5"),children:[a.jsx(n,{size:16}),t&&a.jsx("span",{children:i})]},s)})}),(0,a.jsxs)("div",{className:"p-3 text-xs text-muted-foreground flex items-center gap-2",children:[a.jsx(h.Z,{size:14}),"Live-ready"]})]})}var f=s(1497),b=s(5631);let v=[{label:"Go to Overview",action:()=>"/"},{label:"Go to Timeline",action:()=>"/timeline"},{label:"Go to Decisions",action:()=>"/decisions"},{label:"Go to Trust",action:()=>"/trust"},{label:"Go to Settings",action:()=>"/settings"},{label:"Mission Mode",action:()=>"/mission"},{label:"Alerts Center",action:()=>"/alerts"}];function CommandPalette(){let e=(0,n.useRouter)(),[t,s]=(0,l.useState)(!1),[i,r]=(0,l.useState)(""),[o,c]=(0,l.useState)([]);(0,l.useEffect)(()=>{let handler=()=>s(!0);window.addEventListener("open-command-palette",handler);let e=localStorage.getItem("orion-recent-decisions");return e&&c(JSON.parse(e)),()=>window.removeEventListener("open-command-palette",handler)},[]);let navigate=t=>{s(!1),e.push(t)},handleSearch=()=>{let e=i.trim();e&&(e.startsWith("dec-")?navigate(`/decisions/${e}`):e.startsWith("corr-")?navigate(`/timeline?correlationId=${e}`):e.startsWith("trust:")&&navigate(`/trust/${e.replace("trust:","")}`))},consoleParse=e=>{let t=e.replace(/^>\s*/,""),s=t.split(" ").filter(Boolean),a=s[0];if(a){if("mission"===a)navigate("/mission");else if("alerts"===a)navigate("/alerts");else if("timeline"===a)navigate(`/timeline?${new URLSearchParams(cleanParams(s.slice(1))).toString()}`);else if("open"===a&&"decision"===s[1]&&s[2])navigate(`/decisions/${s[2]}`);else if("open"===a&&"corr"===s[1]&&s[2])navigate(`/timeline?correlationId=${s[2]}`);else if("export"===a&&"decision"===s[1]&&s[2])navigate(`/decisions/${s[2]}`);else if("export"===a&&"corr"===s[1]&&s[2])navigate(`/timeline?correlationId=${s[2]}`);else if("toggle"===a&&"live"===s[1]){let e=new CustomEvent("toggle-live");window.dispatchEvent(e)}else if("toggle"===a&&"hud"===s[1]){let e=new CustomEvent("toggle-hud");window.dispatchEvent(e)}}},cleanParams=e=>{let t={};return e.forEach(e=>{let[s,a]=e.split("=");s&&a&&(t[s]=a)}),t};return a.jsx(f.Command.Dialog,{open:t,onOpenChange:s,label:"Command Palette",className:"fixed inset-0 z-50 flex items-start justify-center bg-black/40 backdrop-blur-sm",children:(0,a.jsxs)(f.Command.List,{className:"w-full max-w-2xl mt-20 rounded-2xl border border-white/10 bg-slate-900 text-foreground shadow-2xl",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 px-4 py-3 border-b border-white/10",children:[a.jsx(b.Z,{size:16,className:"text-primary"}),a.jsx(f.Command.Input,{value:i,onValueChange:r,onKeyDown:e=>{if("Enter"===e.key){if(i.trim().startsWith(">")){consoleParse(i.trim());return}handleSearch()}},placeholder:"Buscar rota ou ID (dec- / corr- / trust:domain)",className:"w-full bg-transparent outline-none text-sm"}),a.jsx("span",{className:"text-[11px] text-muted-foreground",children:"Ctrl/Cmd + K"})]}),a.jsx(f.Command.Empty,{className:"px-4 py-3 text-sm text-muted-foreground",children:"Nenhum comando"}),a.jsx(f.Command.Group,{heading:"Navigation",children:v.map(e=>a.jsx(f.Command.Item,{onSelect:()=>navigate(e.action()),className:"px-4 py-3 text-sm data-[selected=true]:bg-white/5 cursor-pointer",children:e.label},e.label))}),o.length>0&&a.jsx(f.Command.Group,{heading:"Recent decisions",children:o.map(e=>a.jsx(f.Command.Item,{onSelect:()=>navigate(`/decisions/${e}`),className:"px-4 py-3 text-sm data-[selected=true]:bg-white/5 cursor-pointer",children:e},e))}),(0,a.jsxs)(f.Command.Group,{heading:"Quick actions",children:[a.jsx(f.Command.Item,{onSelect:()=>{navigate("/timeline")},className:"px-4 py-3 text-sm data-[selected=true]:bg-white/5 cursor-pointer",children:"Export current view… (use bot\xe3o na p\xe1gina)"}),a.jsx(f.Command.Item,{onSelect:()=>{},className:"px-4 py-3 text-sm data-[selected=true]:bg-white/5 cursor-pointer",children:"Toggle Live Mode"})]})]})})}var j=s(3756),w=s(3754),N=s(7638),y=s(7295),S=s(5342),C=s(6762),k=s(2827),z=s(77),E=s(8534);let useVoiceCommands=()=>{let[e,t]=(0,l.useState)(!1),s=(0,n.useRouter)();return(0,l.useEffect)(()=>{let e=(0,E.P)(),s=window.SpeechRecognition||window.webkitSpeechRecognition;s&&e.voice&&t(!0)},[]),{supported:e,startListening:()=>{let e=window.SpeechRecognition||window.webkitSpeechRecognition;if(!e)return;let t=new e;t.lang="en-US",t.onresult=e=>{let t=e.results[0][0].transcript.toLowerCase();if(t.includes("open mission")&&s.push("/mission"),t.includes("show alerts")&&s.push("/alerts"),t.includes("open timeline")&&s.push("/timeline"),t.includes("search decision")){let e=t.split(" "),a=e[e.length-1];a&&s.push(`/decisions/${a}`)}},t.start()}}};var O=s(9775);function Topbar(){let e=(0,n.useRouter)();(0,n.useSearchParams)();let[t,s]=(0,l.useState)(""),i=(0,j.gV)(),{theme:r,setTheme:c}=(0,k.F)(),{live:d,toggleLive:m}=(0,z.C)(),[x,u]=(0,l.useState)(()=>(0,E.P)().hud),{supported:h,startListening:p}=useVoiceCommands();(0,l.useEffect)(()=>{let handler=e=>{if((e.ctrlKey||e.metaKey)&&"k"===e.key.toLowerCase()){e.preventDefault();let t=new CustomEvent("open-command-palette");window.dispatchEvent(t)}};return window.addEventListener("keydown",handler),()=>window.removeEventListener("keydown",handler)},[]);let g=(0,l.useMemo)(()=>i.isFetching?"checking":i.isError?"offline":i.isSuccess?"online":"checking",[i.isFetching,i.isError,i.isSuccess]),onSearch=()=>{let s=t.trim();s&&(s.startsWith("dec-")?e.push(`/decisions/${s}`):s.startsWith("corr-")?e.push(`/timeline?correlationId=${s}`):e.push(`/timeline?domain=${s}`))};return(0,a.jsxs)("div",{className:"sticky top-0 z-30 backdrop-blur-xl bg-black/20 border-b border-white/10",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 px-4 sm:px-6 lg:px-10 py-3",children:[(0,a.jsxs)("div",{className:"flex-1 flex items-center gap-2",children:[a.jsx("input",{value:t,onChange:e=>s(e.target.value),onKeyDown:e=>"Enter"===e.key&&onSearch(),placeholder:"Buscar decisionId / correlationId / domain",className:"w-full rounded-xl bg-white/5 border border-white/10 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-primary/50","aria-label":"Busca global"}),a.jsx(O.z,{onClick:onSearch,size:"sm","aria-label":"Executar busca",children:"Buscar"})]}),(0,a.jsxs)(O.z,{onClick:m,variant:d?"secondary":"ghost",size:"sm",className:(0,o.cn)(d?"border-emerald-400/50 text-emerald-100 bg-emerald-500/10":"text-muted-foreground"),"aria-label":"Toggle live mode",children:[a.jsx(b.Z,{size:14,className:"mr-1"})," ",d?"Live ON":"Live OFF"]}),a.jsx(ApiStatus,{status:g,retry:i.refetch}),a.jsx(O.z,{"aria-label":"Toggle theme",onClick:()=>c("light"===r?"dark":"light"),variant:"ghost",size:"sm",className:"px-2",children:"light"===r?a.jsx(w.Z,{size:16}):a.jsx(N.Z,{size:16})}),(0,a.jsxs)(O.z,{"aria-label":"Toggle HUD",onClick:()=>{u(e=>{let t=!e;return(0,E.x)({...(0,E.P)(),hud:t}),t})},variant:"ghost",size:"sm",children:["HUD ",x?"ON":"OFF"]}),h&&a.jsx(O.z,{"aria-label":"Voice push-to-talk",onClick:p,variant:"secondary",size:"sm",children:"Voice"})]}),a.jsx(CommandPalette,{})]})}function ApiStatus({status:e,retry:t}){return"checking"===e?(0,a.jsxs)("span",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[a.jsx(y.Z,{className:"animate-spin",size:14})," Checking"]}):"offline"===e?(0,a.jsxs)("button",{onClick:t,className:"flex items-center gap-1 text-xs text-red-300 bg-red-500/10 border border-red-500/30 px-3 py-2 rounded-lg","aria-label":"API offline, retry",children:[a.jsx(S.Z,{size:14})," Offline (retry)"]}):(0,a.jsxs)("span",{className:"flex items-center gap-1 text-xs text-emerald-200 bg-emerald-500/10 border border-emerald-500/30 px-3 py-2 rounded-lg",children:[a.jsx(C.Z,{size:14})," Online"]})}var L=s(1276);let HudOverlay=({alertsCount:e,lastRefresh:t,lagSeconds:s})=>{let i=(0,j.gV)(),{live:r}=(0,z.C)(),[n,o]=(0,l.useState)(!1);if((0,l.useEffect)(()=>{o((0,E.P)().hud)},[]),!n)return null;let c=i.isError?"Offline":"Online";return a.jsx("div",{className:"pointer-events-none fixed inset-x-0 top-2 z-40 px-4 flex justify-center",children:(0,a.jsxs)(L.E.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"pointer-events-auto glass rounded-full px-4 py-2 flex items-center gap-3 border border-white/10 shadow-lg",children:[a.jsx("span",{className:"text-xs text-emerald-200",children:c}),(0,a.jsxs)("span",{className:"text-xs text-muted-foreground",children:["Live: ",r?"ON":"PAUSED"]}),(0,a.jsxs)("span",{className:"text-xs text-muted-foreground",children:["Alerts: ",e]}),void 0!==s&&(0,a.jsxs)("span",{className:"text-xs text-muted-foreground",children:["Lag: ",s,"s"]}),t&&(0,a.jsxs)("span",{className:"text-xs text-muted-foreground",children:["Last: ",t]})]})})};var I=s(178),P=s(986);function OfflineBanner({className:e}){let{health:t,retryAll:s}=(0,j.UE)();return t.isError?(0,a.jsxs)("div",{role:"status","aria-live":"polite",className:(0,o.cn)("flex items-center justify-between gap-3 bg-red-500/10 border border-red-500/30 text-red-50 px-4 py-3 rounded-b-xl shadow-lg",e),children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[a.jsx(I.Z,{size:16,"aria-hidden":!0}),(0,a.jsxs)("div",{children:[a.jsx("p",{className:"font-semibold",children:"API offline"}),a.jsx("p",{className:"text-xs opacity-80",children:"Sem conexao com o Stark Core. Revise rede ou tente novamente."})]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(O.z,{variant:"ghost",size:"sm",onClick:()=>t.refetch(),"aria-label":"Retry health check",children:[a.jsx(P.Z,{size:14,className:"mr-2"})," Retry"]}),(0,a.jsxs)(O.z,{size:"sm",onClick:s,"aria-label":"Retry all requests",children:[a.jsx(P.Z,{size:14,className:"mr-2"})," Retry all"]})]})]}):null}function AppShell({children:e}){return(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-950 via-slate-900 to-black text-foreground flex",children:[a.jsx(Sidebar,{}),(0,a.jsxs)("div",{className:"flex-1 flex flex-col",children:[a.jsx(Topbar,{}),a.jsx(OfflineBanner,{}),a.jsx(HudOverlay,{alertsCount:0}),a.jsx("main",{className:"flex-1 px-4 sm:px-6 lg:px-10 py-6",children:e})]})]})}},77:(e,t,s)=>{s.d(t,{C:()=>useLiveToggle});var a=s(8726);let i="orion-live-mode",useLiveToggle=()=>{let[e,t]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{let e=localStorage.getItem(i);e&&t("true"===e)},[]),{live:e,toggleLive:()=>{t(e=>(localStorage.setItem(i,(!e).toString()),!e))}}}},8534:(e,t,s)=>{s.d(t,{P:()=>loadJarvisSettings,x:()=>saveJarvisSettings});var a=s(8207);let i=a.Ry({hud:a.O7().default(!0),compact:a.O7().default(!1),voice:a.O7().default(!1)}),loadJarvisSettings=()=>i.parse({}),saveJarvisSettings=e=>{}}};