(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{7722:function(e,t,s){Promise.resolve().then(s.bind(s,249))},249:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return OverviewPage}});var n=s(7573),r=s(2056),i=s.n(r),a=s(7653),l=s(6141),d=s(5025),o=s(5562),c=s(10);function startOfHour(e){let t=(0,o.Q)(e);return t.setMinutes(0,0,0),t}var date_fns_isSameHour=function(e,t){let s=startOfHour(e),n=startOfHour(t);return+s==+n};let u=Array.from({length:24},(e,t)=>t),m=Array.from({length:7},(e,t)=>t);function ActivityHeatmap(){var e,t;let s=function(e,t){let s=(0,o.Q)(e);return isNaN(t)?(0,c.L)(e,NaN):(t&&s.setDate(s.getDate()+t),s)}(new Date,-7),r=new Date,i=(0,l.mU)({from:s.toISOString(),to:r.toISOString(),limit:200}),a=null!==(t=null===(e=i.data)||void 0===e?void 0:e.pages.flatMap(e=>e.items))&&void 0!==t?t:[],d=m.map(e=>u.map(t=>{let s=startOfHour(new Date(r.getTime()-864e5*e)),n=a.filter(e=>date_fns_isSameHour(new Date(e.timestamp),s)&&new Date(e.timestamp).getHours()===t).length;return n}));return(0,n.jsxs)("div",{className:"rounded-xl border border-white/10 bg-white/5 p-4",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,n.jsx)("h3",{className:"text-sm font-semibold",children:"Atividade (7 dias)"}),(0,n.jsx)("span",{className:"text-xs text-muted-foreground",children:"Clique em um bloco para filtrar (futuro)"})]}),(0,n.jsx)("div",{className:"grid grid-cols-24 gap-1",children:d.map((e,t)=>e.map((e,s)=>(0,n.jsx)("div",{className:"w-5 h-5 rounded-sm",style:{background:"rgba(59,130,246,".concat(.1+.6*Math.min(1,e/5),")")},title:"".concat(e," eventos")},"".concat(t,"-").concat(s))))})]})}var x=s(9975),h=s(4806),f=s(5390),v=s(4390);function OverviewPage(){var e,t,s,r,o,c,u,m,g,j,p,b,N,w;let y=(0,l.gV)(),O=(0,l.mU)({from:new Date(Date.now()-864e5).toISOString(),limit:20}),D=(0,a.useMemo)(()=>{if(!y.data)return null;let e=Object.values(y.data.scoresByDomain);return e.length?e.reduce((e,t)=>e+t,0)/e.length:null},[y.data]);return(0,n.jsx)(d.Z,{children:(0,n.jsxs)("div",{className:"space-y-10",children:[(0,n.jsxs)("header",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-3xl font-semibold tracking-tight",children:"Painel Stark"}),(0,n.jsx)("p",{className:"text-sm text-muted-foreground",children:"Centro de comando do O.R.I.O.N"})]}),(0,n.jsxs)("div",{className:"flex gap-3 text-sm text-muted-foreground",children:[(0,n.jsx)(i(),{href:"/timeline",className:"underline",children:"Timeline"}),(0,n.jsx)(i(),{href:"/decisions",className:"underline",children:"Decisoes"}),(0,n.jsx)(i(),{href:"/trust",className:"underline",children:"Trust"})]})]}),(0,n.jsxs)("section",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[(0,n.jsx)(KpiCard,{title:"Trust medio",value:D?D.toFixed(2):"...",loading:y.isLoading}),(0,n.jsx)(KpiCard,{title:"Dominios rastreados",value:y.data?Object.keys(y.data.scoresByDomain).length:"...",loading:y.isLoading}),(0,n.jsx)(KpiCard,{title:"Eventos (24h)",value:null!==(N=null===(r=O.data)||void 0===r?void 0:null===(s=r.pages)||void 0===s?void 0:null===(t=s[0])||void 0===t?void 0:null===(e=t.items)||void 0===e?void 0:e.length)&&void 0!==N?N:"...",loading:O.isLoading}),(0,n.jsx)(KpiCard,{title:"API",value:y.isError?"Offline":"Online",loading:y.isLoading})]}),(0,n.jsxs)(h.Zb,{children:[(0,n.jsxs)(h.Ol,{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(h.ll,{children:"Ultimas atividades"}),(0,n.jsx)(h.SZ,{children:"Timeline sanitizada das decisoes recentes"})]}),(0,n.jsx)(f.z,{asChild:!0,variant:"secondary",size:"sm",children:(0,n.jsx)(i(),{href:"/timeline",children:"Ver timeline"})})]}),(0,n.jsxs)(h.aY,{className:"space-y-3",children:[O.isLoading&&(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(v.O,{className:"h-4 w-1/3"}),(0,n.jsx)(v.O,{className:"h-4 w-2/3"})]}),null===(m=O.data)||void 0===m?void 0:null===(u=m.pages)||void 0===u?void 0:null===(c=u[0])||void 0===c?void 0:null===(o=c.items)||void 0===o?void 0:o.slice(0,10).map(e=>{var t;return(0,n.jsxs)("div",{className:"flex items-center justify-between bg-white/5 rounded-lg px-4 py-3 border border-white/5",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm font-medium",children:e.summary}),(0,n.jsxs)("p",{className:"text-xs text-muted-foreground",children:[e.kind," › ",e.domain," › ",new Date(e.timestamp).toLocaleString()]})]}),(0,n.jsx)(i(),{href:"/decisions/".concat(null!==(t=e.decisionId)&&void 0!==t?t:""),className:"text-xs text-primary underline",children:"detalhes"})]},e.id)}),!O.isLoading&&(null!==(w=null===(b=O.data)||void 0===b?void 0:null===(p=b.pages)||void 0===p?void 0:null===(j=p[0])||void 0===j?void 0:null===(g=j.items)||void 0===g?void 0:g.length)&&void 0!==w?w:0)===0&&(0,n.jsx)("div",{className:"text-sm text-muted-foreground",children:"Nenhum evento encontrado."})]})]}),(0,n.jsxs)(h.Zb,{children:[(0,n.jsxs)(h.Ol,{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(h.ll,{children:"Trust por dominio"}),(0,n.jsx)(h.SZ,{children:"Scores e defaults por dominio"})]}),(0,n.jsx)(f.z,{asChild:!0,variant:"secondary",size:"sm",children:(0,n.jsx)(i(),{href:"/trust",children:"Ver detalhes"})})]}),(0,n.jsx)(h.aY,{children:(0,n.jsx)("div",{className:"grid sm:grid-cols-2 lg:grid-cols-3 gap-3",children:y.data?Object.entries(y.data.scoresByDomain).map(e=>{let[t,s]=e;return(0,n.jsxs)("div",{className:"rounded-lg border border-white/5 bg-white/5 p-4",children:[(0,n.jsx)("p",{className:"text-sm text-muted-foreground",children:t}),(0,n.jsx)("p",{className:"text-xl font-semibold",children:s.toFixed(2)})]},t)}):(0,n.jsx)("div",{className:"text-sm text-muted-foreground",children:"Carregando..."})})})]}),(0,n.jsx)(ActivityHeatmap,{}),(0,n.jsx)(x.S,{})]})})}let KpiCard=e=>{let{title:t,value:s,loading:r}=e;return(0,n.jsxs)(h.Zb,{variant:"glow",className:"p-4",children:[(0,n.jsx)("p",{className:"text-sm text-muted-foreground",children:t}),(0,n.jsx)("p",{className:"text-2xl font-semibold",children:r?(0,n.jsx)(v.O,{className:"h-6 w-12"}):s})]})}},9975:function(e,t,s){"use strict";s.d(t,{S:function(){return AlertsPanel}});var n=s(7573),r=s(2056),i=s.n(r),a=s(6141),l=s(5562),d=s(10);function AlertsPanel(){var e,t;let s=(0,a.gV)(),r=(0,a.mU)({from:(function(e,t){let s=+(0,l.Q)(e);return(0,d.L)(e,s+-864e5)})(new Date,-864e5).toISOString(),limit:100}),o=[];s.data&&Object.entries(s.data.scoresByDomain).forEach(e=>{let[t,s]=e;s<.4&&o.push({severity:"critical",message:"Trust baixo em ".concat(t," (").concat(s.toFixed(2),")"),ctaLabel:"Ver trust",ctaHref:"/trust/".concat(t)})});let c=null!==(t=null===(e=r.data)||void 0===e?void 0:e.pages.flatMap(e=>e.items))&&void 0!==t?t:[];return(c.forEach(e=>{var t,s;"permission.decision"===e.type&&"deny"===e.payload.permissionLevel&&o.push({severity:"warn",message:"Permission deny recente",ctaLabel:"Ver timeline filtrada",ctaHref:"/timeline?correlationId=".concat(null!==(t=e.correlationId)&&void 0!==t?t:"")}),"system.no_action"===e.type&&o.push({severity:"info",message:"Sil\xeancio repetido detectado",ctaLabel:"Ver fluxo",ctaHref:"/timeline?correlationId=".concat(null!==(s=e.correlationId)&&void 0!==s?s:"")})}),0===o.length)?(0,n.jsx)("div",{className:"rounded-xl border border-white/10 bg-white/5 p-4 text-sm text-muted-foreground",children:"Nenhum alerta ativo."}):(0,n.jsxs)("div",{className:"rounded-xl border border-white/10 bg-white/5 p-4 space-y-3",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("h3",{className:"text-sm font-semibold",children:"Alertas"}),(0,n.jsxs)("span",{className:"text-xs text-muted-foreground",children:[o.length," ativos"]})]}),(0,n.jsx)("div",{className:"space-y-2",children:o.map((e,t)=>(0,n.jsxs)("div",{className:"rounded-lg border border-white/10 bg-white/5 px-3 py-2 flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm",children:e.message}),(0,n.jsx)("p",{className:"text-xs text-muted-foreground",children:e.severity})]}),(0,n.jsx)(i(),{className:"text-xs text-primary underline",href:e.ctaHref,children:e.ctaLabel})]},t))})]})}},4806:function(e,t,s){"use strict";s.d(t,{Zb:function(){return Card},aY:function(){return CardContent},SZ:function(){return CardDescription},Ol:function(){return CardHeader},ll:function(){return CardTitle}});var n=s(7573),r=s(3883);let i={glass:"bg-white/5 border border-white/10 backdrop-blur-xl",panel:"bg-slate-900/70 border border-white/10",glow:"border border-white/10 bg-white/5 shadow-[0_0_0_1px_rgba(255,255,255,0.06)]"};function Card(e){let{children:t,className:s,variant:a="panel"}=e;return(0,n.jsx)("div",{className:(0,r.cn)("rounded-2xl shadow-lg",i[a],s),children:t})}function CardHeader(e){let{children:t,className:s}=e;return(0,n.jsx)("div",{className:(0,r.cn)("px-5 pt-5 pb-3 flex items-center justify-between gap-3",s),children:t})}function CardTitle(e){let{children:t,className:s}=e;return(0,n.jsx)("h3",{className:(0,r.cn)("text-lg font-semibold tracking-tight",s),children:t})}function CardDescription(e){let{children:t,className:s}=e;return(0,n.jsx)("p",{className:(0,r.cn)("text-sm text-muted-foreground",s),children:t})}function CardContent(e){let{children:t,className:s}=e;return(0,n.jsx)("div",{className:(0,r.cn)("px-5 pb-5",s),children:t})}},4390:function(e,t,s){"use strict";s.d(t,{O:function(){return Skeleton}});var n=s(7573),r=s(3883);function Skeleton(e){let{className:t}=e;return(0,n.jsx)("div",{className:(0,r.cn)("animate-pulse rounded-lg bg-white/10",t)})}},10:function(e,t,s){"use strict";function constructFrom(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}s.d(t,{L:function(){return constructFrom}})},5562:function(e,t,s){"use strict";function toDate(e){let t=Object.prototype.toString.call(e);return e instanceof Date||"object"==typeof e&&"[object Date]"===t?new e.constructor(+e):new Date("number"==typeof e||"[object Number]"===t||"string"==typeof e||"[object String]"===t?e:NaN)}s.d(t,{Q:function(){return toDate}})}},function(e){e.O(0,[274,54,447,786,529,25,293,53,744],function(){return e(e.s=7722)}),_N_E=e.O()}]);