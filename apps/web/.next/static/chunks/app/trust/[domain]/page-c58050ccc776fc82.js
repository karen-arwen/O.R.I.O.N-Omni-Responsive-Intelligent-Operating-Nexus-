(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[110],{8634:function(e,t,a){Promise.resolve().then(a.bind(a,4884))},4884:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return TrustDomainPage}});var n=a(7573),r=a(2859),s=a(2056),i=a.n(s),o=a(6141);function TrustDomainPage(){var e,t,a,s,l;let u=(0,r.useParams)(),c=u.domain,d=(0,o.HW)(c),m=(0,o.mU)({domain:c,kind:"trust",limit:20});return(0,n.jsx)("main",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-950 to-black text-foreground",children:(0,n.jsxs)("div",{className:"mx-auto max-w-4xl px-6 py-10 space-y-6",children:[(0,n.jsxs)("header",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("h1",{className:"text-2xl font-semibold",children:["Trust: ",c]}),(0,n.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Atual: ",d.data?d.data.score.toFixed(2):"—"," ",(null===(e=d.data)||void 0===e?void 0:e.fromDefault)?"(default)":""]})]}),(0,n.jsx)(i(),{href:"/trust",className:"text-sm text-primary underline",children:"Voltar"})]}),(0,n.jsxs)("section",{className:"rounded-xl border border-white/10 bg-white/5 p-4 space-y-3",children:[(0,n.jsx)("h2",{className:"text-lg font-semibold",children:"Atualiza\xe7\xf5es recentes"}),m.isLoading&&(0,n.jsx)("p",{className:"text-sm text-muted-foreground",children:"Carregando..."}),(null!==(s=null===(t=m.data)||void 0===t?void 0:t.pages.flatMap(e=>e.items))&&void 0!==s?s:[]).map(e=>{var t;return(0,n.jsxs)("div",{className:"rounded-lg bg-white/5 border border-white/10 px-3 py-2",children:[(0,n.jsx)("p",{className:"text-sm font-medium",children:e.summary}),(0,n.jsxs)("p",{className:"text-xs text-muted-foreground",children:[e.type," • ",new Date(e.timestamp).toLocaleString()," • ",null!==(t=e.correlationId)&&void 0!==t?t:"—"]})]},e.id)}),!m.isLoading&&(null!==(l=null===(a=m.data)||void 0===a?void 0:a.pages.flatMap(e=>e.items).length)&&void 0!==l?l:0)===0&&(0,n.jsx)("p",{className:"text-sm text-muted-foreground",children:"Sem atualiza\xe7\xf5es."})]})]})})}},7717:function(e,t,a){"use strict";a.d(t,{IA:function(){return fetchHealth},Sk:function(){return fetchSnapshot},kh:function(){return fetchTimeline},m4:function(){return fetchTrust},nz:function(){return fetchTrustDomain},qr:function(){return postFeedback}});var n,r=a(8116),s=a(4850);let i=window.location.origin,o=null!==(n=s.env.NEXT_PUBLIC_ORION_API_BASE_URL)&&void 0!==n?n:i;let ApiError=class ApiError extends Error{constructor(e){super(e.message),this.status=e.status,this.code=e.code,this.details=e.details,this.requestId=e.requestId}};let apiFetch=async(e,t)=>{var a,n,s;let i;let l="".concat(null!=o?o:"").concat(e),u=(0,r.u)(),c={"Content-Type":"application/json"};u.tenantId&&(c["x-tenant-id"]=u.tenantId),u.token&&(c.Authorization="Bearer ".concat(u.token));try{i=await fetch(l,{...t,headers:{...c,...null!==(a=null==t?void 0:t.headers)&&void 0!==a?a:{}}})}catch(e){throw new ApiError({status:0,code:"network_error",message:"Falha de rede ao chamar API",details:e})}if(!i.ok&&304!==i.status){let e=null;try{e=await i.json()}catch(e){}let t=null==e?void 0:e.error;throw new ApiError({status:i.status,code:null!==(n=null==t?void 0:t.code)&&void 0!==n?n:"api_error",message:null!==(s=null==t?void 0:t.message)&&void 0!==s?s:"API error ".concat(i.status),details:null==t?void 0:t.details,requestId:null==t?void 0:t.requestId})}return i};var l=a(8673);let u=l.Ry({id:l.Z_(),type:l.Z_(),timestamp:l.Z_(),decisionId:l.Z_().nullable().optional(),correlationId:l.Z_().nullable().optional(),domain:l.Z_(),kind:l.Km(["decision","trust","system","audit","other"]),summary:l.Z_(),payload:l.IM(l.Yj())}),c=l.Ry({items:l.IX(u),nextCursor:l.Z_().nullable(),capabilities:l.Ry({canExecute:l.O7(),v:l.Z_()})}),d=l.Ry({scoresByDomain:l.IM(l.Rx()),defaultsByDomain:l.IM(l.Rx()),deltas:l.Ry({accept:l.Rx(),reject:l.Rx(),implicitRepeatNoAction:l.Rx()}),lastUpdatedByDomain:l.IM(l.Z_()).optional(),capabilities:l.Ry({canExecute:l.O7(),v:l.Z_()})}),m=l.Ry({decisionId:l.Z_().optional(),correlationId:l.Z_().optional(),snapshot:l.IM(l.Yj()),events:l.IX(l.Ry({id:l.Z_(),type:l.Z_(),timestamp:l.Z_()})),capabilities:l.Ry({canExecute:l.O7(),v:l.Z_()}),etag:l.Z_().optional()}),fetchHealth=async()=>{let e=await apiFetch("/health"),t=await e.json();return l.Ry({status:l.Z_(),uptime:l.Rx(),version:l.Z_().optional(),timestamp:l.Z_()}).parse(t)},fetchTimeline=async e=>{let t=new URLSearchParams;Object.entries(e).forEach(e=>{let[a,n]=e;null!=n&&""!==n&&t.append(a,String(n))});let a=await apiFetch("/timeline?".concat(t.toString())),n=await a.json();return c.parse(n)},fetchTrust=async()=>{let e=await apiFetch("/trust"),t=await e.json();return d.parse(t)},fetchTrustDomain=async e=>{let t=await apiFetch("/trust/".concat(e)),a=await t.json();return l.Ry({domain:l.Z_(),score:l.Rx(),fromDefault:l.O7(),capabilities:l.Ry({canExecute:l.O7(),v:l.Z_()})}).parse(a)},fetchSnapshot=async(e,t)=>{let a=await apiFetch("/decisions/".concat(e,"/snapshot"),{headers:t?{"If-None-Match":t}:void 0});if(304===a.status)return{fromCache:!0,etag:t};let n=await a.json();return{fromCache:!1,...m.parse(n)}},postFeedback=async e=>{let{decisionId:t,accepted:a,rejected:n}=e,r=await apiFetch("/decisions/".concat(t,"/feedback"),{method:"POST",body:JSON.stringify({accepted:a,rejected:n})}),s=await r.json();return l.Ry({decisionId:l.Z_(),domain:l.Z_(),trust:l.Ry({oldScore:l.Rx(),newScore:l.Rx()}).optional(),feedback:l.Km(["accepted","rejected"]),capabilities:l.Ry({canExecute:l.O7(),v:l.Z_()})}).parse(s)}},6141:function(e,t,a){"use strict";a.d(t,{UE:function(){return useApiHealth},Ho:function(){return useFeedbackMutation},RK:function(){return useSnapshot},mU:function(){return useTimeline},gV:function(){return useTrust},HW:function(){return useTrustDomain}});var n=a(1708),r=a(1501),s=a(40),i=a(604),o=a(7717);let l={timeline:e=>["timeline",e],trust:["trust"],trustDomain:e=>["trust",e],snapshot:e=>["snapshot",e],health:["health"]},u={},recordLatency=(e,t)=>{var a;let n=null!==(a=u[e])&&void 0!==a?a:{name:e,value:0,count:0};n.value=n.value+(t-n.value)/(n.count+1),n.count+=1,u[e]=n};var c=a(7653);let useTimeline=e=>(0,n.N)({queryKey:l.timeline(e),queryFn:async t=>{let{pageParam:a}=t,n=performance.now(),r=await (0,o.kh)({...e,cursor:a});return recordLatency("timeline",performance.now()-n),r},getNextPageParam:e=>{var t;return null!==(t=e.nextCursor)&&void 0!==t?t:void 0},enabled:!!(e.correlationId||e.decisionId||e.domain||e.types||e.from||e.to),staleTime:15e3}),useTrust=()=>(0,r.a)({queryKey:l.trust,queryFn:o.m4,staleTime:3e4}),useTrustDomain=e=>(0,r.a)({queryKey:l.trustDomain(e),queryFn:()=>(0,o.nz)(e),staleTime:3e4,enabled:!!e}),useHealth=()=>(0,r.a)({queryKey:l.health,queryFn:o.IA,refetchInterval:15e3,retry:1}),useSnapshot=e=>{let t=(0,s.NL)();return(0,r.a)({queryKey:l.snapshot(e),queryFn:async a=>{let{queryKey:n}=a,r=t.getQueryData(n);return(0,o.Sk)(e,null==r?void 0:r.etag)},staleTime:6e4,enabled:!!e})},useFeedbackMutation=()=>{let e=(0,s.NL)();return(0,i.D)({mutationFn:o.qr,onSuccess:()=>{e.invalidateQueries({queryKey:l.trust})}})},useApiHealth=()=>{let e=(0,s.NL)(),t=useHealth(),a=(0,c.useCallback)(()=>(e.invalidateQueries(),t.refetch()),[t,e]);return{health:t,retryAll:a}}},8116:function(e,t,a){"use strict";a.d(t,{S:function(){return saveAuthSettings},u:function(){return loadAuthSettings}});let n="orion-auth-settings",r={tenantId:"local",roles:["admin"]},s=r,loadAuthSettings=()=>{let e="undefined"!=typeof localStorage;if(!e)return s;try{var t;let e=localStorage.getItem(n);if(!e)return s;let a=JSON.parse(e);return s={...r,...a,roles:null!==(t=a.roles)&&void 0!==t?t:r.roles}}catch(e){return s}},saveAuthSettings=e=>{var t;s={...r,...e,roles:null!==(t=e.roles)&&void 0!==t?t:r.roles},"undefined"!=typeof localStorage&&localStorage.setItem(n,JSON.stringify(s))}}},function(e){e.O(0,[274,54,447,293,53,744],function(){return e(e.s=8634)}),_N_E=e.O()}]);